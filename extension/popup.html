<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Secure Manager</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="container">

        <!-- Login View -->
        <div id="login-view">
             <div class="popup-header">
                 <h2>Secure Login</h2>
             </div>
            <div class="content-area">
                <div id="login-error" class="status-message status-error hidden"></div>
                <label for="email">Email:</label>
                <input type="email" id="email" placeholder="Enter your email" required>
                <label for="masterPasswordLogin">Master Password:</label>
                <input type="password" id="masterPasswordLogin" placeholder="Enter Master Password" required>
                <button id="login-btn" class="btn btn-primary">Login</button> <!-- Applied general button style -->
            </div>
        </div>

        <!-- Main Logged-In View -->
        <div id="main-view" class="hidden">
             <div class="popup-header">
                 <h2>Credentials</h2>
                 <!-- Add Theme Toggle Button -->
                 <div id="theme-toggle-container">
                    <button id="popup-theme-toggle" title="Toggle light/dark theme">☀️</button>
                 </div>
                 <button id="logout-btn">Logout</button>
             </div>
             <div class="content-area">
                 <!-- Display Current Domain -->
                 <div class="main-header">
                    <span id="current-domain" title="Current Tab Domain">Domain: N/A</span>
                 </div>
                <input type="search" id="search-input" placeholder="Filter by service name...">
                <div id="status-indicator" class="status-message status-info hidden"></div>
                <div class="password-list-container">
                    <ul id="password-list">
                        <!-- List items are generated by popup.js -->
                        <!-- Example Structure (for reference):
                        <li class="password-item" data-encrypted="..." data-service-hint="...">
                            <div style="flex-grow: 1; overflow: hidden;">
                                <div class="item-info">
                                    <strong>Service Hint</strong>
                                    <span class="username-display">(Username Hidden)</span>
                                </div>
                                <div class="strength-display-popup score-x">Strength: ...</div>
                                <div class="breach-display-popup">Breach: ...</div> // <-- Add this
                            </div>
                            <div class="item-actions">
                                <button>Show</button>
                                <button style="display: none;">Copy</button>
                                <button style="display: none;">Fill</button>
                            </div>
                        </li>
                        -->
                    </ul>
                </div>
                <button id="add-password-btn" class="btn btn-secondary btn-add-toggle">+ Add New Credential</button>

                <!-- Add/Edit Form -->
                <div id="add-password-form" class="add-form hidden">
                    <h3>Add New Credential</h3>
                    <div id="save-error" class="status-message status-error hidden"></div>
                    <label for="service">Service/Website:</label>
                    <input type="text" id="service" placeholder="e.g., Google, Example.com" required>
                    <label for="new-username">Username/Email:</label>
                    <input type="text" id="new-username" placeholder="Your username or email" required>

                    <div class="label-button-group">
                         <label for="new-password">Password:</label>
                         <button type="button" id="generate-popup-password-btn" class="btn btn-outline-secondary">Generate</button>
                    </div>
                    <input type="password" id="new-password" placeholder="Enter or generate password" required>

                    <!-- Popup Strength Display -->
                    <div id="popup-strength-area" class="popup-strength-area" style="display: none;">
                        <!-- ... strength meter ... -->
                        <div id="popup-strength-feedback"></div>
                        <!-- ** NEW: Popup Breach Status ** -->
                        <div id="popup-breach-status" class="breach-status-area" style="display: none; margin-top: 5px; font-size: 0.85em;">
                             <span class="breach-label">Breach:</span>
                             <span id="popup-breach-indicator" class="breach-indicator">Checking...</span>
                        </div>
                         <!-- ** END Popup Breach Status ** -->
                    </div>

                    <!-- Generator Options -->
                    <div class="popup-generator-options">
                         <h4>Generator Options</h4>
                         <div class="popup-length-control"> <label for="popup-gen-length">Length:</label> <input type="range" id="popup-gen-length" name="popup-gen-length" min="8" max="64" value="16"> <span class="popup-length-display" id="popup-gen-length-value">16</span> </div>
                         <div class="popup-char-options">
                             <div class="popup-option-group"> <input type="checkbox" id="popup-gen-lowercase" checked> <label for="popup-gen-lowercase">a-z</label> </div>
                             <div class="popup-option-group"> <input type="checkbox" id="popup-gen-uppercase" checked> <label for="popup-gen-uppercase">A-Z</label> </div>
                             <div class="popup-option-group"> <input type="checkbox" id="popup-gen-digits" checked> <label for="popup-gen-digits">0-9</label> </div>
                             <div class="popup-option-group"> <input type="checkbox" id="popup-gen-symbols" checked> <label for="popup-gen-symbols">!@#</label> </div>
                         </div>
                     </div>

                    <label for="masterPasswordSave">Confirm Master Password:</label>
                    <input type="password" id="masterPasswordSave" placeholder="Enter Master Password to save" required>
                    <div class="form-buttons">
                        <button id="save-password-btn" class="btn btn-primary">Encrypt & Save</button>
                        <button type="button" id="cancel-add-btn" class="btn btn-secondary">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Include zxcvbn library FIRST -->
    <script src="zxcvbn.js"></script>
    <!-- Then other helpers and main popup script -->
    <script src="crypto-helpers.js"></script>
    <script src="popup.js"></script>
</body>
</html>